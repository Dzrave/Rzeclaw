# 蜂群智能团队：愿景与整体设计方案

本文档定义 Rzeclaw 的**产品定位**与**整体架构愿景**：从「单点 CLI/助手」升级为**可主动执行、可协作、可进化的私人智能团队**，覆盖项目开发、知识库构建、项目管理等多维度，具备蜂群机制、自主性与可进化能力，安全且隐私优先。**仅设计不实现。**

---

## 一、定位与愿景

### 1.1 它是什么（定位）

- **不是**：又一个「你问一句、它答一句」的 CLI 或聊天机器人；也不是「仅在你发消息时才动」的被动工具。
- **而是**：  
  - **你的私人智能团队**：像一支半托管或全托管的「员工/代理团队」，可以**主动**领取你给出的任务，**自主**分解、执行或协助你完成，并在开发、知识库、项目管理等多方面形成**蜂群式协作**。  
  - **全栈型助手**：在软件开发（写码、调试、重构、集成）、知识库构建（摄取、索引、检索、答疑）、项目管理（目标、任务、进度、画布、汇报）等维度上，统一在一个体系内工作，而不是割裂的多个工具。  
  - **可进化、可自我迭代**：能力边界通过配置、技能、记忆与反馈逐步扩展；系统可产出改进建议并纳入下一次行为，形成闭环。  
  - **安全且隐私优先**：数据与执行均在你可控环境内（本地/自托管），无强制第三方依赖，可审计、可约束。

一句话：**一个属于你的、能主动干活、多维度协作、可持续进化的蜂群智能团队，而不是一个只会回话的 CLI。**

### 1.2 与 OpenClaw 的对比（为何要自己做）

- **能力对标**：在「工具调用、多轮对话、可扩展技能、控制台/终端」等基础能力上，与 OpenClaw 类似，便于你理解与迁移习惯。  
- **超越点**：  
  - **主动与蜂群**：强调「无指令时也能按节奏做事」「多角色/多任务协同」，而非仅多 Channel 接入。  
  - **记忆与知识**：内置 L0/L1/L2 记忆与任务感知检索，与「知识库构建与咨询」深度结合，而不是外挂知识库。  
  - **画布与项目管理**：Canvas、任务体系、提议与执行分离，直接支撑「项目管理」与「进度可见、人机对齐」。  
  - **完全自主与隐私**：无第三方 Channel 依赖，终端与数据均可自托管，适合「私人团队」的合规与安全诉求。  
- **量身定制**：架构与节奏按「开发 + 知识库 + 项目管理 + 蜂群 + 进化」一条线设计，可随你需求迭代，不被上游产品路线绑架。

---

## 二、核心设计原则

1. **主动优先**：系统应能在「无用户输入」时按策略唤醒（Heartbeat）、检查待办、产出提议或执行约定任务；用户可半托管或全托管。  
2. **蜂群协作**：多任务、多上下文（如多 workspace/多项目）可在同一体系内由「逻辑上的多角色或多会话」协同完成，任务可分解、可委托、可汇总。  
3. **多维一体**：项目开发、知识库、项目管理共用同一套记忆、画布、工具与会话底座，避免数据与能力割裂。  
4. **提议与执行分离**：主动输出以「提议/建议」为主，涉及写盘、发信等敏感操作需用户确认或授权，避免擅自行动。  
5. **可进化**：通过 Bootstrap 文档、Prompt 建议、Skill/MCP 扩展、记忆与审计反馈，使系统在使用中持续变好。  
6. **安全与隐私**：本地/自托管优先，认证与审计可配置，无强制公网第三方。

---

## 三、蜂群机制（整体模型）

### 3.1 概念

- **蜂群**：不要求「多个物理进程或多种模型」，而是**逻辑上的多角色、多任务、多会话协同**。  
  - 可体现为：同一 Agent 在不同「会话/workspace/任务」中扮演不同角色（如开发、知识库维护、PM）；  
  - 或未来扩展为：多个轻量 Agent 实例（如开发 Agent、知识库 Agent、PM Agent）共享记忆与画布，由统一协调层分配任务与汇总结果。  
- **当前阶段**：以**单 Agent + 多会话 + 多 workspace + 任务/画布/提议**为主，通过「任务体系、Canvas、Heartbeat、主动提议」实现「多任务并行感」与「主动推进」；多 Agent 编排可作为后续阶段扩展。

### 3.2 协作维度

- **任务维度**：用户或系统产生的「待办/目标」进入统一任务体系（如 tasks.json、HEARTBEAT.md、Canvas 目标）；Heartbeat 或主动推理会读取这些任务，决定「谁来做、何时做、做到哪一步」，并写回进度与产物。  
- **上下文维度**：按 **workspace / 项目 / 会话** 隔离；同一用户可有「项目 A 的开发」「项目 B 的知识库」「全局 PM」等不同上下文，记忆与画布按 workspace 或项目隔离，避免串台。  
- **角色维度**（可选扩展）：在 prompt 或配置中为不同「会话类型」或「任务类型」赋予角色（如「你负责前端开发」「你负责知识库答疑」），使单 Agent 在行为上呈现「团队分工」感；后续可升级为多 Agent 分工。

### 3.3 与「主动」的结合

- **Heartbeat**：定时唤醒 → 读任务/清单/画布 → 决策是否执行 → 执行（或只汇报）→ 写回结果；形成「无人发消息时也在推进」的节奏。  
- **主动提议**：事件或用户打开终端时，根据任务、记忆、画布做需求推断，产出「建议/待决策项」，由用户确认后再执行，实现「主动但可控」。  
- **画布**：当前目标、步骤、产物对用户可见；蜂群（或单 Agent 多任务）写回画布，便于你查看「团队在做什么、做到哪了」。

---

## 四、能力支柱（三大维度）

系统在以下三个维度提供统一能力，共用底层记忆、工具与画布。

### 4.1 项目开发（软件开发辅助）

- **目标**：全栈辅助你完善项目——写码、改码、调试、重构、运行与集成，而非仅回答「怎么写」。  
- **能力**：  
  - **工具**：bash、read、write、edit、process，以及 Skill、MCP，使助手能真正操作代码库、运行命令、调用外部能力。  
  - **规划与执行**：复杂需求先拆步（轻量规划），再按步执行并写回 Canvas；支持多轮工具调用与反思。  
  - **上下文**：当前 workspace 即项目根；记忆与任务感知检索使助手「记得」项目约定与历史决策。  
- **与蜂群的关系**：开发任务可进入任务体系，由 Heartbeat 或你指派执行；多项目时通过多 workspace/多会话并行推进。

### 4.2 知识库构建与咨询

- **目标**：构建并维护你的知识库，并基于知识库进行咨询式对话（问答、溯源、推荐）。  
- **能力**：  
  - **记忆底座**：L0（会话内摘要）、L1（事实与摘要）、L2（去重与长期知识），带 task_hint、workspace 隔离与审计。  
  - **检索与注入**：会话前根据当前问题与 task_hint 检索相关记忆，以「带引用的记忆块」注入 prompt，实现「依据知识库作答」与可解释引用。  
  - **知识库构建**：通过对话、文档摄取（如 read + 摘要写入记忆）、或专用「知识摄取」任务，持续往 L1/L2 写入；冷归档与审计便于长期维护。  
- **与蜂群的关系**：知识库任务（如「整理某类文档」「更新某主题」）可进入任务体系，由 Heartbeat 或主动提议触发；咨询会话与开发/PM 会话共享同一记忆层但可区分 workspace。

### 4.3 项目管理

- **目标**：目标、任务、进度、产物可见可管，人机对齐，便于你掌控「团队在做什么、做到哪」。  
- **能力**：  
  - **画布（Canvas）**：当前目标、步骤列表、当前步骤索引、关键产物；Agent 在规划/执行中写回，Gateway 暴露 canvas.get/update，终端可展示与编辑。  
  - **任务体系**：结构化任务（如 tasks.json、HEARTBEAT.md 解析），状态与来源可追踪；主动推理与 Heartbeat 读取任务并产出提议或执行。  
  - **提议与执行分离**：主动输出为「建议/待办建议」，执行需你确认；避免自动改重要文件或发信。  
- **与蜂群的关系**：画布与任务体系是「蜂群」共享的工作区；多任务进度、多项目里程碑可在同一套结构中表达。

---

## 五、自主性与主动机制（再强调）

- **触发方式**：  
  - **定时**：Heartbeat 按配置间隔唤醒。  
  - **事件**（可选）：文件变更、日历、或「长时间未用后首次打开」等，触发一次主动推理或提议。  
  - **显式**：用户点击「获取建议」或打开终端时请求一次 proactive.suggest。  
- **行为**：读任务、读记忆、读画布 → 需求推断与提议生成 → 输出「建议列表/待决策项」；若策略允许且有待办，Heartbeat 可进一步调用 runAgentLoop 执行一条任务并写回。  
- **边界**：敏感操作（写关键文件、发信、删数据等）通过「提议 + 用户确认」或审批策略控制，不擅自执行。

---

## 六、可进化与自我迭代

- **Bootstrap**：工作区级最佳实践文档（如 WORKSPACE_BEST_PRACTICES.md）在会话中只读注入，使助手遵循你的项目约定。  
- **Prompt 建议**：会话结束后由模型产出 1～3 条「可改进的 prompt 建议」，写入文件供你采纳，形成「用一次、改一点」的闭环。  
- **Skill / MCP**：通过本地 Skill 目录与 MCP 服务扩展工具集，无需改核心代码即可增加能力。  
- **记忆与审计**：记忆的写入与检索、审计日志与冷归档，为「哪些被记住了、哪些被用了」提供反馈，便于你调整策略或清理数据。  
- **未来**：可预留「自我诊断与改进建议」接口（如定期产出「系统行为报告 + 改进建议」），由你或半自动流程采纳，实现更高阶的自我迭代。

---

## 七、安全与隐私

- **数据与运行**：数据与执行均在本地或你自托管的环境内；不强制依赖公网第三方服务；终端与 Gateway 可完全在内网运行。  
- **认证与访问控制**：Gateway 可配置认证（如 API Key/Token）；终端与多用户场景下可按 identity/workspace 做访问约束；文档明确快照与审计的权限建议。  
- **审计与合规**：写入操作可审计（谁、何时、从哪、写入了什么）；敏感信息在写入记忆前可过滤或脱敏；冷归档与导出便于合规留存。  
- **提议与执行分离**：减少「误执行」风险；关键操作需显式确认。

---

## 八、系统边界与形态（不是 CLI）

- **交互形态**：以**终端（自制 Channel）**或后续 iOS 客户端为主入口；用户通过「会话 + 画布 + 任务/提议」与系统交互，而不是在命令行里逐条敲命令。  
- **使用方式**：  
  - **半托管**：你下达目标或任务，系统主动提议或按 Heartbeat 执行一部分，关键决策与敏感操作由你确认。  
  - **全托管**：在安全边界内（如限定目录、限定操作类型），系统按任务清单与 Heartbeat 自主推进，你主要做抽查与纠偏。  
- **与 CLI 的关系**：CLI 可作为「轻量入口」或运维脚本存在（如启动 Gateway、健康检查、导出审计），但**主体验**是「智能团队 + 终端/客户端」，不是「又一个 CLI 工具」。

---

## 九、整体架构示意（逻辑视图）

```
                    ┌─────────────────────────────────────────────────────────┐
                    │                    你（用户）                             │
                    └───────────────────────────┬─────────────────────────────┘
                                                │
                    ┌───────────────────────────▼─────────────────────────────┐
                    │  终端 / 客户端（自制 Channel，未来 + iOS）                 │
                    │  会话 · 画布 · 任务列表 · 提议 · 设置                      │
                    └───────────────────────────┬─────────────────────────────┘
                                                │ WebSocket (WS/WSS) · 认证
                    ┌───────────────────────────▼─────────────────────────────┐
                    │  Gateway（会话调度、协议、多 workspace）                    │
                    └───────────────────────────┬─────────────────────────────┘
                                                │
        ┌───────────────────────────────────────┼───────────────────────────────────────┐
        │                                       │                                       │
        ▼                                       ▼                                       ▼
┌───────────────┐                     ┌───────────────┐                     ┌───────────────┐
│ 主动 / 节奏   │                     │  Agent 核心   │                     │ 记忆 · 知识   │
│ Heartbeat     │◄───────────────────►│ runAgentLoop  │◄───────────────────►│ L0/L1/L2      │
│ 主动提议      │                     │ 规划 · 工具   │                     │ 检索 · 审计   │
│ 任务体系      │                     │ 反思 · 画布   │                     │ 冷归档        │
└───────────────┘                     └───────┬───────┘                     └───────────────┘
        │                                       │
        │                             ┌─────────▼─────────┐
        │                             │ 工具层            │
        │                             │ CORE + Skill+MCP  │
        └────────────────────────────│ bash read write   │
                                      │ edit process …    │
                                      └──────────────────┘
        ┌───────────────────────────────────────┐
        │  Canvas · 任务 · workspace 隔离         │
        └───────────────────────────────────────┘
```

- **蜂群**在逻辑上体现为：多会话/多 workspace/多任务 + Heartbeat + 主动提议 + 画布与任务体系，共享同一 Agent、记忆与工具层；未来可在 Gateway 与 Agent 之间增加「协调层」实现多 Agent 分工。

---

## 十、阶段与路线图（建议）

- **当前（已有）**：单 Agent、记忆 L0/L1/L2、Canvas、Heartbeat、Skill/MCP、主动提议、任务与画布写回、Gateway + 协议。  
- **下一阶段（建议优先）**：  
  - 终端（自制 Channel）落地，使「主体验」脱离 CLI，实现会话、画布、提议的完整交互。  
  - Gateway 支持绑定 0.0.0.0 与认证，支持局域网多机与交叉控制。  
  - 任务体系与 Heartbeat 策略增强（如更丰富的清单解析、可选 LLM 判断是否执行）。  
- **后续**：  
  - 多 Agent 或「角色/会话类型」分工（开发 / 知识库 / PM），共享记忆与画布。  
  - 知识库构建流水线（批量摄取、索引、检索增强）与咨询专用入口。  
  - 自我诊断与改进建议（报告 + 建议）与半自动采纳流程。

---

## 十一、小结：定位再明确

| 维度 | 定位 |
|------|------|
| **是什么** | 你的私人蜂群智能团队：主动、多维（开发+知识库+PM）、可进化、安全隐私优先。 |
| **不是什么** | 不是「又一个 CLI」；不是「仅被动回复」的聊天机器人；不依赖第三方 Channel。 |
| **与 OpenClaw** | 能力对标，但在主动、蜂群、记忆与画布、隐私与自主上量身定制并可超越。 |
| **核心机制** | 蜂群（多任务/多上下文/可选多角色）、Heartbeat、主动提议、画布与任务体系、提议与执行分离。 |
| **能力支柱** | 项目开发、知识库构建与咨询、项目管理，共用记忆与工具。 |
| **进化** | Bootstrap、Prompt 建议、Skill/MCP、记忆与审计反馈，可持续迭代。 |

本文档作为整体愿景与架构的锚点；具体实现仍以《自主性、Skill/MCP 与主动模式设计》《终端 Channel 设计》《Phase 6 工单》等为准，分阶段落地。
